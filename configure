#! /bin/sh
# 
# Copyright 2010-2011 DIMA Research Group, TU Berlin
# 
# Licensed under the Apache License, Version 2.0 (the "License");
# you may not use this file except in compliance with the License.
# You may obtain a copy of the License at
# 
#     http://www.apache.org/licenses/LICENSE-2.0
# 
# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an "AS IS" BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
# See the License for the specific language governing permissions and
# limitations under the License.
# 
# Configuration script for Myriad-based data generator projects.
#
# Created on Oct 17, 2011
# 
# @author: Alexander Alexandrov <alexander.alexandrov@tu-berlin.de>
#

showhelp()
{
cat << ENDHELP 
usage: configure {options}
Configure the myriad-dgen build.

Options:
  --help
    Display this help screen.

  --prefix=<install_prefix>
    Use the given install directory for make install.
    Default is /usr/local.
    
  --poco-prefix=<install_prefix>
    Prefix path where the POCO C++ Libraries are installed.
    Default is /usr/local.

ENDHELP
}

# save cwd
build=`pwd`
# get directory where we are located
cd `dirname $0`
base=`pwd`
cd $build
if [ `uname` = "QNX" ] ; then
	EXPR=expr
	NOTFOUND=0
else
	EXPR="expr --"
	NOTFOUND=""
fi

dgen=""
prefix=""
pocoprefix=""

# parse arguments
while [ "$1" != "" ] ; do
	
	val=`$EXPR "$1" : '--prefix=\(.*\)'`
	if [ "$val" != "$NOTFOUND" ] ; then
		prefix=$val
	fi

	val=`$EXPR "$1" : '--poco-prefix=\(.*\)'`
	if [ "$val" != "$NOTFOUND" ] ; then
		pocoprefix=$val
	fi

	if [ "$1" = "--help" ] ; then
		showhelp
		exit 0
	fi

	shift
done

if [ "$prefix" = "" ] ; then
	prefix=/usr/local
fi

if [ "$pocoprefix" = "" ] ; then
	pocoprefix=/usr/local
fi

# create config.make
echo '# makefile.defs generated by configure script' >./makefile.defs
echo "" >>./makefile.defs
echo "MYRIAD_INSTALL_DIR = $prefix" >>./makefile.defs
echo "POCO_INCLUDE_PATH  = $pocoprefix/include" >>./makefile.defs
echo "POCO_LIBRARY_PATH  = $pocoprefix/lib" >>./makefile.defs

echo "Updated configuration"
